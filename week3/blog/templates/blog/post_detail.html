<!-- blog/templates/blog/post_detail.html -->
{% extends 'base.html' %}

{% block title %}{{ post.title }} - My Blog{% endblock %}

{% block content %}
<div class="card">
    <h1>{{ post.title }}</h1>

    <div class="meta">
        By {{ post.author.username }} |
        {{ post.created_at|date:"F d, Y" }} |
        {{ post.views }} views
    </div>

    <div style="margin: 1rem 0;">
        {% for category in post.categories.all %}
        <a href="{% url 'blog:category_posts' category.slug %}" class="badge badge-warning">
            {{ category.name }}
        </a>
        {% endfor %}
    </div>

    <div style="margin-top: 2rem; line-height: 1.8;">
        {{ post.content|linebreaks }}
    </div>
</div>

{% if user.is_authenticated and user == post.author %}
<div class="card">
    <h3>Manage Post</h3>
    <a href="{% url 'blog:post_edit' post.slug %}" class="btn" style="margin-right: 0.5rem;">
        âœï¸ Edit Post
    </a>
    <a href="{% url 'blog:post_delete' post.slug %}" class="btn" style="background: #e74c3c;">
        ğŸ—‘ï¸ Delete Post
    </a>
</div>
{% endif %}


<!-- Comments Section -->
<div class="card">
    <h3>Comments ({{ comments.count }})</h3>

    <div style="margin-bottom: 1rem;">
        <a href="{% url 'blog:add_comment' post.slug %}" class="btn">
            ğŸ’¬ Add Comment
        </a>
    </div>

    {% if comments %}
    {% for comment in comments %}
    <div style="border-left: 3px solid #3498db; padding-left: 1rem; margin: 1rem 0;">
        <strong>{{ comment.author_name }}</strong>
        <span class="meta">{{ comment.created_at|date:"F d, Y" }}</span>
        <p>{{ comment.content }}</p>
    </div>
    {% endfor %}
    {% else %}
    <p>No comments yet. Be the first to comment!</p>
    {% endif %}
</div>

<!-- Related Posts -->
{% if related_posts %}
<div class="card">
    <h3>Related Posts</h3>
    {% for related in related_posts %}
    <div style="margin: 1rem 0;">
        <a href="{% url 'blog:post_detail' related.slug %}">
            <strong>{{ related.title }}</strong>
        </a>
        <div class="meta">{{ related.created_at|date:"F d, Y" }}</div>
    </div>
    {% endfor %}
</div>
{% endif %}

<div style="text-align: center; margin-top: 2rem;">
    <a href="{% url 'blog:post_list' %}" class="btn">â† Back to All Posts</a>
</div>
{% endblock %}